<!DOCTYPE html>
<html lang="ru">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Игорь Фокусов">
    <meta name="description" content="Услуги профессионального программиста 1с в Череповце. тел. &#43;7 921 548-69-50">
    <meta name="keywords" content="1с предприятие, услуги 1с, программист 1с, 1с8, 1с83, сопровождение 1с, поддержка 1с, программист череповец, 1с программист, 1с программист череповец, стоимость услуг 1с, специалист 1с, программист 1с удаленно">

    <base href="https://fokusov.com/">
    <title>
  Создание мультиязычного приложения NativeScript · Фокусов Игорь
</title>

    <link rel="canonical" href="https://fokusov.com/posts/sozdanie-multijazychnogo-prilozhenija-nativescript/">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700|Merriweather:300,700|Source+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />
    
    <link href="https://fonts.googleapis.com/css?family=Roboto&amp;subset=cyrillic" rel="stylesheet"> 
    

    
      
      
      <link rel="stylesheet" href="https://fokusov.com/css/coder.min.578f8fce262e4c448c239b69661084c57507b89d51b8d04de15cd1d8f8135600.css" integrity="sha256-V4&#43;PziYuTESMI5tpZhCExXUHuJ1RuNBN4VzR2PgTVgA=" media="screen">
    

    

    
      <link rel="stylesheet" href="https://fokusov.com/mycss/custom.css">
    

    <link rel="icon" type="image/png" href="https://fokusov.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://fokusov.com/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.49" />
  </head>

  <body class="">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://fokusov.com/">
      Фокусов Игорь
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://fokusov.com/about/">Обо мне</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://fokusov.com/projects/">1С</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://fokusov.com/android/">Android</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://fokusov.com/contacts/">Контакты</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://fokusov.com/posts/">Блог</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <h1 class="title">Создание мультиязычного приложения NativeScript</h1>
        <h2 class="date">January 2017</h2>
      </header>

      <div>
        

<p>Для недавнего проекта мне понадобилось решение для мгновенного переключения языка с Нидерландского на Английский.</p>

<p>В одном концепте на NativeScript я разработал собственное решение на чистом <a href="https://tehnojam.pro/tag/javascript/">JavaScript</a> с <a href="https://github.com/messageformat/Jed">Jed</a>. Оно работало, но было далеко не идеальным.<br />
После этого я решил создать приложение на NativeScript с Angular (2+) и начал поиск существующих библиотек локализации для Angular. Лучшим решением оказалась библиотека <a href="https://github.com/ocombe/ng2-translate">ng-translate</a> от <a href="https://twitter.com/OCombe">Olivier Combe</a>.</p>

<p>В Angular она завелась с полпинка, а вот заставить её работать в NativeScript стоило мне много крови и пота. Но благодаря сообществу вокруг NativeScript и персонально Nathan Walker, мне удалось это сделать. И, в принципе, это было не так сложно.</p>

<p>Вы можете выполнить описанное ниже или же просто скачать готовый пример <a href="https://github.com/nativescriptnl/NSNL_Multilingual">NSNL_Multilingual</a> с GitHub.</p>

<h4 id="1-создание-приложения-на-nativescript-и-angular">1. Создание приложения на NativeScript и Angular</h4>

<p>С помощью следующих команд мы создадим новый проект и добавим в него платформы <a href="https://tehnojam.pro/tag/android/">Android</a> и <a href="https://tehnojam.pro/tag/ios/">iOS</a>.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">tns create projectname --ng
cd projectname
tns platform add android
tns platform add ios</pre></div>
<h4 id="2-установка-ng2-translate">2. Установка ng2-translate</h4>

<p>ng2-translate это пакет npm, поэтому он устанавливается стандартно:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">npm install ng2-translate --save</pre></div>
<h4 id="3-создание-языковых-файлов">3. Создание языковых файлов</h4>

<p>Создадим папку <strong>i18n</strong> в папке <strong>app</strong> нашего проекта и добавим файлы nl.json и en.json.<br />
<strong>nl.json</strong></p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">{
    &#34;EXAMPLE&#34;: {
        &#34;TITLE&#34;: &#34;Hallo wereld!&#34;,
        &#34;TEXT&#34;: &#34;Dit is een zin in het Nederlands.&#34;,
        &#34;BACK&#34;: &#34;Terug&#34;
    }
}</pre></div>
<p><strong>en.json</strong></p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">{
    &#34;EXAMPLE&#34;: {
         &#34;TITLE&#34;: &#34;Hello world!&#34;,
         &#34;TEXT&#34;: &#34;This is a sentence in English.&#34;,
         &#34;BACK&#34;: &#34;Back&#34;
    }
}</pre></div>
<h4 id="4-отредактируем-файл-app-module-ts">4. Отредактируем файл app.module.ts</h4>

<p>Здесь нам нужно импортировать следующие модули:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">import {NativeScriptHttpModule} from &#34;nativescript-angular/http&#34;;
import {TranslateModule, TranslateLoader, TranslateStaticLoader} from &#34;ng2-translate&#34;;
import {Http} from &#34;@angular/http&#34;;</pre></div>
<p>NativeScript использует <a href="https://angular.io/docs/ts/latest/cookbook/aot-compiler.html">AOT компиляцию</a>, поэтому нам нужно экспортировать функцию, которая возвращает <strong>TranslateStaticLoader</strong>.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">// for AoT compilation
export function translateLoaderFactory(http: Http) {
    return new TranslateStaticLoader(http, &#34;/i18n&#34;, &#34;.json&#34;);
};</pre></div>
<p>Также нам нужно расширить импорты <strong>@NgModule</strong>:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">NativeScriptHttpModule,
TranslateModule.forRoot([{
    provide: TranslateLoader,
    deps: [Http],
    useFactory: (translateLoaderFactory)}])</pre></div>
<h4 id="5-отредактируем-app-component-html">5. Отредактируем app.component.html</h4>

<p>Замените содержитое файла <strong>app.component.html</strong> следующей разметкой.<br />
С помощью неё мы привязываем EXAMPLE.TITLE к тексту в ActionBar, компоненту Label и содержимому TextView.<br />
Также у нас есть кнопки для переключения между Нидерландским и Английским языками. Эти кнопки вызывают функцию <strong>changeLanguage</strong> при нажатии.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;ActionBar [title]=&#34;&#39;EXAMPLE.TITLE&#39; | translate&#34;&gt;&lt;/ActionBar&gt;
&lt;ScrollView&gt;
    &lt;StackLayout&gt;
        &lt;Label [text]=&#34;&#39;EXAMPLE.TITLE&#39; | translate&#34;&gt;&lt;/Label&gt;
        &lt;TextView editable=&#34;false&#34; [text]=&#34;&#39;EXAMPLE.TEXT&#39; | translate&#34;&gt;&lt;/TextView&gt;
        &lt;Button text=&#34;Nederlands&#34; (tap)=&#34;changeLanguage(&#39;nl&#39;)&#34;&gt;&lt;/Button&gt;
        &lt;Button text=&#34;English&#34; (tap)=&#34;changeLanguage(&#39;en&#39;)&#34;&gt;&lt;/Button&gt;
    &lt;/StackLayout&gt;
&lt;/ScrollView&gt;</pre></div>
<h4 id="6-отредактируем-app-component-ts">6. Отредактируем app.component.ts</h4>

<p>Сначала нам нужно импортировать следующие модули:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">import * as Platform from &#34;platform&#34;;
import {TranslateService} from &#39;ng2-translate&#39;;</pre></div>
<p>При инициализации мы установим язык по-умолчанию в Нидерландский.<br />
После этого изменим язык, основываясь на предпочитаемом языке на устройстве. В случае, если для такого языка у нас нет файла локализации, ng2-translate вернёт язык по-умолчанию.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">constructor(private translate: TranslateService) {
    this.translate.setDefaultLang(&#34;nl&#34;);
    this.translate.use(Platform.device.language);
}</pre></div>
<p>Также нам нужна функция для переключения языков:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">public changeLanguage(lang: string) {
    this.translate.use(lang);
}</pre></div>
<p>Готово! За шесть простых шагов мы создали мультиязычное приложение на NativeScript!</p>

<p>Рекомендую посмотреть более расширенный пример <a href="https://github.com/nativescriptnl/NSNL_Multilingual">NSNL_Multilingual</a> на GitHub, в котором также используется <a href="https://angular.io/docs/ts/latest/guide/router.html">Angular routing</a>.</p>

<p>*Оригинал взят на <a href="https://nativescript.nl/tips/how-to-create-a-multilingual-nativescript-app/">NativeScript.nl</a></p>

      </div>

      <footer>
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "fokusovcom" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </footer>
    </article>

    <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$']],
        displayMath: [['$$','$$']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
    MathJax.Hub.Queue(function() {
      
      
      
      var all = MathJax.Hub.getAllJax(), i;
      for(i = 0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
     
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-54274841-9', 'auto');
	
	ga('send', 'pageview');
}
</script>


 <script type="text/javascript" > (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter16914967 = new Ya.Metrika({ id:16914967, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/16914967" style="position:absolute; left:-9999px;" alt="" /></div></noscript> 

  </body>

</html>
